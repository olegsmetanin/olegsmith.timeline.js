/*!
 * olegsmith Timeline
 * Licensed under the MIT License.
 * Version: 0.1
 */
// Build: 23.08.2012 20:42:56,02 
var olegsmith=olegsmith||{},global=function(){return this||(1,eval)("this")}();olegsmith.div=function(e){return"<div"+(typeof e.cssclass!="undefined"?' class="'+e.cssclass.join(" ")+'"':"")+(typeof e.style!="undefined"?' style="'+e.style.join(";")+'"':"")+">"+(typeof e.inner!="undefined"?e.inner:"")+(typeof e.innerfn!="undefined"?e.innerfn():"")+"</div>"};typeof olegsmith!="undefined"&&(olegsmith.Timeline=olegsmith.Timeline||{});typeof olegsmith!="undefined"&&typeof olegsmith.Timeline.Math=="undefined"&&(olegsmith.Timeline.Math={init:function(){for(var e=0;e<47;e++)this.ZOOMPIX[e]=256*Math.pow(2,e);return this},TICKMAX:864e13,TICKMIN:-864e13,TICKLEN:1728e13,ZOOMPIX:[],dticks2dpix:function(e,t){return this.ZOOMPIX[t]*e/this.TICKLEN},dpix2dticks:function(e,t){return this.TICKLEN*e/this.ZOOMPIX[t]},ticks2pix:function(e,t){return(t.direction==="h"?t.width:t.height)*3/2-(t.direction==="h"?1:-1)*(t.center_tick-e)*this.ZOOMPIX[t.zoom]/this.TICKLEN},pix2ticks:function(e,t){return t.center_tick-(t.direction==="h"?1:-1)*((t.direction==="h"?t.width:t.height)*3/2-e)*this.TICKLEN/this.ZOOMPIX[t.zoom]},minmax:function(e){var t=(e.direction==="h"?e.width:e.height)*1.5*this.TICKLEN/this.ZOOMPIX[e.zoom],n=e.center_tick-t,r=e.center_tick+t;return{min:n<this.TICKMIN?this.TICKMIN:n,max:r>this.TICKMAX?this.TICKMAX:r}},zoomto:function(e,t,n){var r=this.pix2ticks(e,t);return r+(t.direction==="h"?1:-1)*this.dpix2dticks((t.direction==="h"?t.width:t.height)*1.5-e,n)},shift:function(e,t){return t.center_tick-this.dpix2dticks(e,t.zoom)},periodfn:function(e){var t,n,r;switch(e){case"second":n=function(e,t){var n=new Date(e);return n.setSeconds(0,0),n.getTime()},t=function(e,t){return e+t*1e3},r=function(e,t){var n=new Date(e);return n.setMinutes(n.getMinutes()+1),n.getTime()};break;case"minute":n=function(e,t){var n=new Date(e);return n.setMinutes(0,0,0),n.getTime()},t=function(e,t){return e+t*60*1e3},r=function(e){var t=new Date(e);return t.setHours(t.getHours()+1),t.getTime()};break;case"hour":n=function(e,t){var n=new Date(e);return n.setHours(0,0,0,0),n.getTime()},t=function(e,t){return e+t*60*60*1e3},r=function(e,t){var n=new Date(e);return n.setDate(n.getDate()+1),n.getTime()};break;case"day":n=function(e,t){var n=new Date(e);return n.setHours(0,0,0,0),n.setDate(1),n.getTime()},t=function(e,t){return e+t*24*60*60*1e3},r=function(e,t){var n=new Date(e);return n.setHours(0,0,0,0),n.setDate(1),n.setMonth(n.getMonth()+1),n.getTime()};break;case"month":n=function(e,t){var n=new Date(e);return n.setHours(0,0,0,0),n.setDate(1),n.setMonth(0),n.getTime()},t=function(e,t){var n=new Date(e);return n.setMonth(n.getMonth()+t),n.getTime()},r=function(e,t){var n=new Date(e);return n.setHours(0,0,0,0),n.setDate(1),n.setMonth(0),n.setFullYear(n.getFullYear()+1),n.getTime()};break;case"year":n=function(e,t){function n(e){var n=new Date(e),r=new Date(e);return n.setHours(0,0,0,0),n.setDate(1),n.setMonth(0),n.setFullYear(r.getFullYear()-r.getFullYear()%t),n}var r,i=new Date(e);while(isNaN(r=n(i)))i.setFullYear(i.getFullYear()+t);return r.getTime()},t=function(e,t){var n=new Date(e);return n.setFullYear(n.getFullYear()+t),n.getTime()},r=function(e,t){var n=new Date(e);return n.setHours(0,0,0,0),n.setDate(1),n.setMonth(0),n.setFullYear(n.getFullYear()+t),n.getTime()}}return{adddeltafn:t,periodstartfn:n,periodendfn:r}},calcmarktic:function(e,t,n,r){var i=[],s=this.periodfn(n),o=s.periodstartfn(e,r);while(o<t){var u=s.periodstartfn(o,r),a=s.periodendfn(u,r);while(o<a)o>=e&&o<=t&&i.push(o),o=s.adddeltafn(o,r),n==="day"&&r>1&&(new Date(o)).getDate()>29&&(o=a);o=a}return i},diffarray:function(e,t){var n=[];for(var r=e.length;r;){var i=e[--r],s=!1;for(var o=t.length;o;)if(i===t[--o]){s=!0;break}s||n.push(i)}return n}}.init());typeof olegsmith!="undefined"&&typeof olegsmith.Timeline.Util=="undefined"&&(olegsmith.Timeline.Util={init:function(){return this},rendergridmarks:function(e,t,n,r,i,s,o,u,a){var f=olegsmith.Timeline.Math,l="",c=a.direction==="h",h,p;for(var d=e.length;d;){var v=e[--d];c?(h=f.ticks2pix(v,a),p=n):(h=r,p=f.ticks2pix(v,a)),l+=olegsmith.div({cssclass:[o],style:["width:"+i+"px","height:"+s+"px","left:"+h+"px","top:"+p+"px","position:absolute"]})+olegsmith.div({cssclass:[u],style:["left:"+(h+2)+"px","top:"+p+"px","position:absolute","white-space: nowrap"],inner:(new Date(v)).format(t)})}return l},rendernow:function(e){var t=e.direction==="h";return olegsmith.div({cssclass:[e.nowline_class],style:["position:absolute","top:"+(t?0:olegsmith.Timeline.Math.ticks2pix(new Date,e))+"px","left:"+(t?olegsmith.Timeline.Math.ticks2pix(new Date,e):0)+"px","width:"+(t?1:e.width)+"px","height:"+(t?e.height:1)+"px","background-color:#000"]})+olegsmith.div({cssclass:[e.nowlinelbl_class],style:["position:absolute","top:"+(t?20:olegsmith.Timeline.Math.ticks2pix(new Date,e)+2)+"px","left:"+(t?olegsmith.Timeline.Math.ticks2pix(new Date,e)+2:20)+"px"],inner:"Now"})}}.init());typeof olegsmith!="undefined"&&typeof olegsmith.Timeline.VControl=="undefined"&&(olegsmith.Timeline.VControl=function(e,t,n){var r=$(e),i,s,o,u,a=this,f,l,c;this.init=function(){r.mousewheel(function(e,n){var r=i.position().top+(n>0?1:-1)*40;return r>0||r<-2*t.height?(console.log("bound"),t.center_tick=olegsmith.Timeline.Math.shift(-(t.height+r),t),a.render()):i.css({top:r}),f&&window.clearTimeout(f),f=window.setTimeout(function(){t.center_tick=olegsmith.Timeline.Math.shift(-(t.height+r),t),a.render()},100),!1}).drag("start",function(e){l=e.clientY,c=t.center_tick}).drag(function(e,n){var r=-t.height+e.clientY-l;r>0||r<-2*t.height?(t.center_tick=olegsmith.Timeline.Math.shift(-(e.clientY-l),t),a.render(),l=e.clientY,c=t.center_tick):i.css({top:r})}).drag("end",function(e,n){t.center_tick=c,t.center_tick=olegsmith.Timeline.Math.shift(-(e.clientY-l),t),a.render()}).dblclick(function(e){t.zoom<42&&(t.center_tick=olegsmith.Timeline.Math.zoomto(e.pageY-r.position().top-i.position().top,t,t.zoom+1),t.zoom=t.zoom+1,a.render())}),this.render()},this.resize=function(){t.width=r.width(),this.render()},this.update=function(){s.html(t.updatefn())},this.zoomin=function(){t.zoom<42&&(t.zoom++,this.render())},this.zoomout=function(){t.zoom>0&&(t.zoom--,this.render())},this.now=function(){t.center_tick=(new Date).getTime(),this.render()},this.render=function(){var e=$(olegsmith.div({cssclass:[t.background_class],style:["position:absolute","width:100%","height:100%","left:0px","top:0px"]}));i=$(olegsmith.div({cssclass:[t.container_class],style:["display:block","position:absolute","width:"+r.width()+"px","height:"+r.height()*3+"px","top:-"+r.height()+"px"],innerfn:function(){return olegsmith.Timeline.VControl.Grid.render(r,t)}})),s=$(olegsmith.div({cssclass:[t.userlayer_class],innerfn:function(){return t.updatefn(t)}})),u=$(olegsmith.div({cssclass:[t.nowline_class]})),o=$(olegsmith.div({cssclass:[t.scale_class],style:["position:absolute","top:0px","left:0px"],inner:"Timescale"})),i.append(s),i.append(u),r.html(""),r.append(e),r.append(i),r.append(o),o.mousedown(function(e){i.trigger(e)}),function n(){var e=olegsmith.Timeline.Math.dpix2dticks(1,t.zoom),r=e*(t.direction==="h"?t.width:t.height)*1.5,i=(new Date).getTime();i<t.center_tick-r?(u.html(""),window.setTimeout(n,t.center_tick-r-i)):i>t.center_tick-r&&i<t.center_tick+r?(u.html(olegsmith.Timeline.Util.rendernow(t)),window.setTimeout(n,e*5)):u.html("")}()}});typeof olegsmith!="undefined"&&typeof olegsmith.Timeline!="undefined"&&typeof olegsmith.Timeline.VControl!="undefined"&&typeof olegsmith.Timeline.VControl.Grid=="undefined"&&(olegsmith.Timeline.VControl.Grid={init:function(){return this},render:function(e,t){var n=olegsmith.Timeline.Math,r=t.width-180,i=olegsmith.Timeline.HConst.zoomdef[t.zoom],s=n.minmax(t),o=n.calcmarktic(s.min,s.max,i.minormark.type,i.minormark.delta),u=n.calcmarktic(s.min,s.max,i.majormark.type,i.majormark.delta),a=n.diffarray(o,u);return olegsmith.div({cssclass:[t.timelayer_class],inner:olegsmith.div({cssclass:[t.axis_class],style:["height:"+t.height*3+"px","width:2px","left:"+r+"px","top:0px","position:absolute"]})+olegsmith.Timeline.Util.rendergridmarks(a,i.minormark.format,0,r,40,1,t.minormark_class,t.minorlabel_class,t)+olegsmith.Timeline.Util.rendergridmarks(u,i.majormark.format,0,r,80,1,t.majormark_class,t.majorlabel_class,t)})}}.init());typeof olegsmith!="undefined"&&typeof olegsmith.Timeline.HControl=="undefined"&&(olegsmith.Timeline.HControl=function(e,t,n){var r=$(e),i,s,o,u,a=this,f,l;this.init=function(){r.mousewheel(function(e,n){if(!(t.zoom<=0&&n<0||t.zoom>42&&n>0)){var s=t.zoom+(n>0?1:-1);t.center_tick=olegsmith.Timeline.Math.zoomto(e.clientX-r.position().left-i.position().left,t,s),t.zoom=s,a.render()}return!1}).drag("start",function(e){f=e.clientX,l=t.center_tick}).drag(function(e,n){var r=-t.width+e.clientX-f;r>0||r<-2*t.width?(t.center_tick=olegsmith.Timeline.Math.shift(e.clientX-f,t),a.render(),f=e.clientX,l=t.center_tick):i.css({left:r})}).drag("end",function(e,n){t.center_tick=l,t.center_tick=olegsmith.Timeline.Math.shift(e.clientX-f,t),a.render()}),this.render()},this.resize=function(){t.width=r.width(),this.render()},this.update=function(){s.html(t.updatefn())},this.zoomin=function(){t.zoom<42&&(t.zoom++,this.render())},this.zoomout=function(){t.zoom>0&&(t.zoom--,this.render())},this.now=function(){t.center_tick=(new Date).getTime(),this.render()},this.render=function(){var e=$(olegsmith.div({cssclass:[t.background_class],style:["position:absolute","width:100%","height:100%","left:0px","top:0px"]}));i=$(olegsmith.div({cssclass:[t.container_class],style:["display:block","position:absolute","width:"+r.width()*3+"px","height:"+r.height()+"px","left:-"+r.width()+"px"],innerfn:function(){return olegsmith.Timeline.HControl.Grid.render(r,t)}})),s=$(olegsmith.div({cssclass:[t.userlayer_class],innerfn:function(){return t.updatefn(t)}})),u=$(olegsmith.div({cssclass:[t.nowline_class]})),o=$(olegsmith.div({cssclass:[t.scale_class],style:["position:absolute","top:0px","left:0px"],inner:"Timescale"})),i.append(s),i.append(u),r.html(""),r.append(e),r.append(i),r.append(o),console.log("render"),o.mousedown(function(e){i.trigger(e)}),function n(){var e=olegsmith.Timeline.Math.dpix2dticks(1,t.zoom),r=e*(t.direction==="h"?t.width:t.height)*1.5,i=(new Date).getTime();i<t.center_tick-r?(u.html(""),window.setTimeout(n,t.center_tick-r-i)):i>t.center_tick-r&&i<t.center_tick+r?(u.html(olegsmith.Timeline.Util.rendernow(t)),window.setTimeout(n,e*5)):u.html("")}()}});typeof olegsmith.Timeline!="undefined"&&typeof olegsmith.Timeline.HControl.Grid=="undefined"&&(olegsmith.Timeline.HControl.Grid={init:function(){return this},render:function(e,t){var n=olegsmith.Timeline.Math,r=t.height-40,i=olegsmith.Timeline.HConst.zoomdef[t.zoom],s=n.minmax(t),o=n.calcmarktic(s.min,s.max,i.minormark.type,i.minormark.delta),u=n.calcmarktic(s.min,s.max,i.majormark.type,i.majormark.delta);return olegsmith.div({cssclass:[t.timelayer_class],inner:olegsmith.div({cssclass:[t.axis_class],style:["width:"+t.width*3+"px","height:1px","left:0px","top:"+r+"px","position:absolute"]})+olegsmith.Timeline.Util.rendergridmarks(o,i.minormark.format,r,0,1,20,t.minormark_class,t.minorlabel_class,t)+olegsmith.Timeline.Util.rendergridmarks(u,i.majormark.format,r+20,0,1,40,t.majormark_class,t.majorlabel_class,t)})}}.init());typeof olegsmith!="undefined"&&typeof olegsmith.Timeline.HConst=="undefined"&&(olegsmith.Timeline.HConst={init:function(){return this},zoomdef:[{minormark:{type:"year",delta:2e5,format:"Y"},majormark:{type:"year",delta:1e6,format:"Y"}},{minormark:{type:"year",delta:1e5,format:"Y"},majormark:{type:"year",delta:1e6,format:"Y"}},{minormark:{type:"year",delta:5e4,format:"Y"},majormark:{type:"year",delta:1e5,format:"Y"}},{minormark:{type:"year",delta:2e4,format:"Y"},majormark:{type:"year",delta:1e5,format:"Y"}},{minormark:{type:"year",delta:1e4,format:"Y"},majormark:{type:"year",delta:5e4,format:"Y"}},{minormark:{type:"year",delta:5e3,format:"Y"},majormark:{type:"year",delta:2e4,format:"Y"}},{minormark:{type:"year",delta:2e3,format:"Y"},majormark:{type:"year",delta:1e4,format:"Y"}},{minormark:{type:"year",delta:1e3,format:"Y"},majormark:{type:"year",delta:5e3,format:"Y"}},{minormark:{type:"year",delta:500,format:"Y"},majormark:{type:"year",delta:5e3,format:"Y"}},{minormark:{type:"year",delta:500,format:"Y"},majormark:{type:"year",delta:1e3,format:"Y"}},{minormark:{type:"year",delta:200,format:"Y"},majormark:{type:"year",delta:1e3,format:"Y"}},{minormark:{type:"year",delta:50,format:"y"},majormark:{type:"year",delta:100,format:"Y"}},{minormark:{type:"year",delta:20,format:"y"},majormark:{type:"year",delta:100,format:"Y"}},{minormark:{type:"year",delta:10,format:"y"},majormark:{type:"year",delta:100,format:"Y"}},{minormark:{type:"year",delta:5,format:"y"},majormark:{type:"year",delta:50,format:"Y"}},{minormark:{type:"year",delta:5,format:"y"},majormark:{type:"year",delta:20,format:"Y"}},{minormark:{type:"year",delta:1,format:"y"},majormark:{type:"year",delta:10,format:"Y"}},{minormark:{type:"year",delta:1,format:"y"},majormark:{type:"year",delta:10,format:"Y"}},{minormark:{type:"month",delta:4,format:"M"},majormark:{type:"year",delta:1,format:"Y"}},{minormark:{type:"month",delta:3,format:"f"},majormark:{type:"year",delta:1,format:"Y"}},{minormark:{type:"month",delta:3,format:"f"},majormark:{type:"year",delta:1,format:"Y"}},{minormark:{type:"month",delta:1,format:"f"},majormark:{type:"month",delta:6,format:"f Y"}},{minormark:{type:"day",delta:10,format:"d"},majormark:{type:"month",delta:1,format:"f Y"}},{minormark:{type:"day",delta:3,format:"d"},majormark:{type:"month",delta:1,format:"f Y"}},{minormark:{type:"day",delta:1,format:"d"},majormark:{type:"month",delta:1,format:"d f Y"}},{minormark:{type:"day",delta:1,format:"d"},majormark:{type:"day",delta:7,format:"d f Y"}},{minormark:{type:"day",delta:1,format:"d F"},majormark:{type:"day",delta:3,format:"d f Y"}},{minormark:{type:"hour",delta:6,format:"H:i"},majormark:{type:"day",delta:1,format:"d f Y"}},{minormark:{type:"hour",delta:6,format:"H:i"},majormark:{type:"day",delta:1,format:"d f Y"}},{minormark:{type:"hour",delta:2,format:"H:i"},majormark:{type:"hour",delta:12,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:60,format:"H:i"},majormark:{type:"hour",delta:6,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:60,format:"H:i"},majormark:{type:"hour",delta:3,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:20,format:"H:i"},majormark:{type:"hour",delta:1,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:10,format:"H:i"},majormark:{type:"hour",delta:1,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:5,format:"H:i"},majormark:{type:"minute",delta:30,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:2,format:"H:i"},majormark:{type:"minute",delta:20,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:1,format:"H:i"},majormark:{type:"minute",delta:5,format:"H:i, d f Y"}},{minormark:{type:"minute",delta:1,format:"H:i"},majormark:{type:"minute",delta:5,format:"H:i, d f Y"}},{minormark:{type:"second",delta:20,format:"H:i:s"},majormark:{type:"minute",delta:1,format:"H:i:s, d f Y"}},{minormark:{type:"second",delta:10,format:"H:i:s"},majormark:{type:"minute",delta:1,format:"H:i:s, d f Y"}},{minormark:{type:"second",delta:5,format:"H:i:s"},majormark:{type:"second",delta:30,format:"H:i:s, d f Y"}},{minormark:{type:"second",delta:2,format:"H:i:s"},majormark:{type:"second",delta:20,format:"H:i:s, d f Y"}},{minormark:{type:"second",delta:2,format:"H:i:s"},majormark:{type:"second",delta:10,format:"H:i:s, d f Y"}},{minormark:{type:"second",delta:1,format:"H:i:s"},majormark:{type:"second",delta:5,format:"H:i:s, d f Y"}}]}.init());(function(e){"use strict";var t={init:function(t){return this.each(function(){var n=e(this),r=n.data("timeline"),i=e.extend({direction:"h",background_class:"tml-bg",container_class:"tml-wrp",center_date:new Date,zoom:36,width:n.width(),height:n.height(),axis_class:"tml-ax",minormark_class:"tml-minmrk",majormark_class:"tml-majmrk",minorlabel_class:"tml-minlbl",majorlabel_class:"tml-majlbl",timelayer_class:"tml-timelayer",userlayer_class:"tml-userlayer",scale_class:"tml-scale",scalecontainer_class:"tml-scalewrp",nowline_class:"tml-now",nowlinelbl_class:"tml-nowlbl",updatefn:function(){},ticks2pix:function(e){return olegsmith.Timeline.Math.ticks2pix(e,this)},zoomOnWheel:!1},t);i.center_tick=i.center_date.getTime();if(!r){n.css("overflow","hidden"),n.css("position","relative");var s={},o=i.direction==="h"?new olegsmith.Timeline.HControl(this,i,s):new olegsmith.Timeline.VControl(this,i,s);o.init(),e(this).data("timeline",{target:n,timeline:o}),e(window).bind("debouncedresize.timeline.olegsmith",function(){o.resize()})}})},destroy:function(){return this.each(function(){var t=e(this),n=t.data("timeline");e(window).unbind(".timeline.olegsmith"),n.timeline.remove(),t.removeData("timeline")})},update:function(){var t=e(this),n=t.data("timeline"),r=n.timeline;r.update()},zoomin:function(){var t=e(this),n=t.data("timeline"),r=n.timeline;r.zoomin()},zoomout:function(){var t=e(this),n=t.data("timeline"),r=n.timeline;r.zoomout()},now:function(){var t=e(this),n=t.data("timeline"),r=n.timeline;r.now()}};e.fn.timeline=function(n){if(t[n])return t[n].apply(this,Array.prototype.slice.call(arguments,1));if(typeof n=="object"||!n)return t.init.apply(this,arguments);e.error("Method "+n+" does not exist on jQuery.timeline")}})(jQuery);Date.prototype.format=function(e){var t="",n=Date.replaceChars;for(var r=0;r<e.length;r++){var i=e.charAt(r);n[i]?t+=n[i].call(this):t+=i}return t},Date.replaceChars={d:function(){return(this.getDate()<10?"0":"")+this.getDate()},D:function(){return olegsmith.Language.shortDays[this.getDay()]},j:function(){return this.getDate()},l:function(){return olegsmith.Language.longDays[this.getDay()]},b:function(){return olegsmith.Language.shortDays[this.getDay()]},N:function(){return this.getDay()+1},S:function(){return this.getDate()%10==1&&this.getDate()!==11?"st":this.getDate()%10==2&&this.getDate()!==12?"nd":this.getDate()%10===3&&this.getDate()!==13?"rd":"th"},w:function(){return this.getDay()},z:function(){return"Not Yet Supported"},W:function(){var e=new Date(this.getFullYear(),0,1);return"week "+Math.ceil(((this-e)/864e5+e.getDay()+1)/7)},F:function(){return olegsmith.Language.longMonths[this.getMonth()]},f:function(){return olegsmith.Language.longMonths2[this.getMonth()]},m:function(){return(this.getMonth()<9?"0":"")+(this.getMonth()+1)},M:function(){return olegsmith.Language.shortMonths[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){return"Not Yet Supported"},L:function(){return this.getFullYear()%4==0&&this.getFullYear()%100!=0||this.getFullYear()%400==0?"1":"0"},o:function(){return"Not Supported"},Y:function(){return this.getFullYear()},y:function(){var e=""+this.getFullYear();return e.substr(e.length-2,2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){return"Not Yet Supported"},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){return((this.getHours()%12||12)<10?"0":"")+(this.getHours()%12||12)},H:function(){return(this.getHours()<10?"0":"")+this.getHours()},i:function(){return(this.getMinutes()<10?"0":"")+this.getMinutes()},s:function(){return(this.getSeconds()<10?"0":"")+this.getSeconds()},e:function(){return"Not Yet Supported"},I:function(){return"Not Supported"},O:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},P:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+":"+(Math.abs(this.getTimezoneOffset()%60)<10?"0":"")+Math.abs(this.getTimezoneOffset()%60)},T:function(){var e=this.getMonth();this.setMonth(0);var t=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");return this.setMonth(e),t},Z:function(){return-this.getTimezoneOffset()*60},c:function(){return this.format("Y-m-d")+"T"+this.format("H:i:sP")},r:function(){return this.toString()},U:function(){return this.getTime()/1e3}},Date.prototype.setISO8601=function(e){var t="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",n=e.match(new RegExp(t)),r=0,i=new Date(n[1],0,1);n[3]&&i.setMonth(n[3]-1),n[5]&&i.setDate(n[5]),n[7]&&i.setHours(n[7]),n[8]&&i.setMinutes(n[8]),n[10]&&i.setSeconds(n[10]),n[12]&&i.setMilliseconds(Number("0."+n[12])*1e3),n[14]&&(r=Number(n[16])*60+Number(n[17]),r*=n[15]==="-"?1:-1),r-=i.getTimezoneOffset();var s=Number(i)+r*60*1e3;this.setTime(Number(s))},Date.prototype.add=function(e,t){e=e.replace(/s$/).toLowerCase();switch(e){case"year":this.setYear(this.getYear()+t);break;case"month":this.setMonth(this.getMonth()+t);break;case"week":this.setTime(this.getTime()+t*6048e5);break;case"day":this.setTime(this.getTime()+t*864e5);break;case"hour":this.setTime(this.getTime()+t*36e5);break;case"minute":this.setTime(this.getTime()+t*6e4);break;case"second":this.setTime(this.getTime()+t*1e3);break;case"nanosecond":default:this.setTime(this.getTime()+t)}return this},Date.prototype.subtract=function(e,t){e=e.replace(/s$/).toLowerCase();switch(e){case"year":this.setYear(this.getYear()-t);break;case"month":this.setMonth(this.getMonth()-t);break;case"week":this.setTime(this.getTime()-t*6048e5);break;case"day":this.setTime(this.getTime()-t*864e5);break;case"hour":this.setTime(this.getTime()-t*36e5);break;case"minute":this.setTime(this.getTime()-t*6e4);break;case"second":this.setTime(this.getTime()-t*1e3);break;case"nanosecond":break;default:this.setTime(this.getTime()-t)}},Date.prototype.truncate=function(e,t){e=e.replace(/s$/).toLowerCase();switch(e){case"year":this.setMonth(0,1),this.setHours(0,0,0,0);break;case"month":this.setDate(1),this.setHours(0,0,0,0);break;case"week":this.subtract("day",this.getDay());break;case"day":this.setMinutes(0,0,0,0);break;case"hour":this.setMinutes(0,0,0);break;case"minute":this.setSeconds(0,0);break;case"second":this.setMilliseconds(0);break;default:}return this}; 
/*! 
 * jquery.event.drag - v 2.2
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */// Created: 2008-06-04 
// Updated: 2012-05-21
// REQUIRES: jquery 1.7.x
(function(e){e.fn.drag=function(t,n,r){var i=typeof t=="string"?t:"",s=e.isFunction(t)?t:e.isFunction(n)?n:null;return i.indexOf("drag")!==0&&(i="drag"+i),r=(t==s?n:r)||{},s?this.bind(i,r,s):this.trigger(i)};var t=e.event,n=t.special,r=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,r.datakey),i=t.data||{};n.related+=1,e.each(r.defaults,function(e,t){i[e]!==undefined&&(n[e]=i[e])})},remove:function(){e.data(this,r.datakey).related-=1},setup:function(){if(e.data(this,r.datakey))return;var n=e.extend({related:0},r.defaults);e.data(this,r.datakey,n),t.add(this,"touchstart mousedown",r.init,n),this.attachEvent&&this.attachEvent("ondragstart",r.dontstart)},teardown:function(){var n=e.data(this,r.datakey)||{};if(n.related)return;e.removeData(this,r.datakey),t.remove(this,"touchstart mousedown",r.init),r.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",r.dontstart)},init:function(i){if(r.touched)return;var s=i.data,o;if(i.which!=0&&s.which>0&&i.which!=s.which)return;if(e(i.target).is(s.not))return;if(s.handle&&!e(i.target).closest(s.handle,i.currentTarget).length)return;r.touched=i.type=="touchstart"?this:null,s.propagates=1,s.mousedown=this,s.interactions=[r.interaction(this,s)],s.target=i.target,s.pageX=i.pageX,s.pageY=i.pageY,s.dragging=null,o=r.hijack(i,"draginit",s);if(!s.propagates)return;o=r.flatten(o),o&&o.length&&(s.interactions=[],e.each(o,function(){s.interactions.push(r.interaction(this,s))})),s.propagates=s.interactions.length,s.drop!==!1&&n.drop&&n.drop.handler(i,s),r.textselect(!1),r.touched?t.add(r.touched,"touchmove touchend",r.handler,s):t.add(document,"mousemove mouseup",r.handler,s);if(!r.touched||s.live)return!1},interaction:function(t,n){var i=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new r.callback,droppable:[],offset:i}},handler:function(i){var s=i.data;switch(i.type){case!s.dragging&&"touchmove":i.preventDefault();case!s.dragging&&"mousemove":if(Math.pow(i.pageX-s.pageX,2)+Math.pow(i.pageY-s.pageY,2)<Math.pow(s.distance,2))break;i.target=s.target,r.hijack(i,"dragstart",s),s.propagates&&(s.dragging=!0);case"touchmove":i.preventDefault();case"mousemove":if(s.dragging){r.hijack(i,"drag",s);if(s.propagates){s.drop!==!1&&n.drop&&n.drop.handler(i,s);break}i.type="mouseup"};case"touchend":case"mouseup":default:r.touched?t.remove(r.touched,"touchmove touchend",r.handler):t.remove(document,"mousemove mouseup",r.handler),s.dragging&&(s.drop!==!1&&n.drop&&n.drop.handler(i,s),r.hijack(i,"dragend",s)),r.textselect(!0),s.click===!1&&s.dragging&&e.data(s.mousedown,"suppress.click",(new Date).getTime()+5),s.dragging=r.touched=!1}},hijack:function(n,i,s,o,u){if(!s)return;var a={event:n.originalEvent,type:n.type},f=i.indexOf("drop")?"drag":"drop",l,c=o||0,h,p,d,v=isNaN(o)?s.interactions.length:o;n.type=i,n.originalEvent=null,s.results=[];do if(h=s.interactions[c]){if(i!=="dragend"&&h.cancelled)continue;d=r.properties(n,s,h),h.results=[],e(u||h[f]||s.droppable).each(function(o,u){d.target=u,n.isPropagationStopped=function(){return!1},l=u?t.dispatch.call(u,n,d):null,l===!1?(f=="drag"&&(h.cancelled=!0,s.propagates-=1),i=="drop"&&(h[f][o]=null)):i=="dropinit"&&h.droppable.push(r.element(l)||u),i=="dragstart"&&(h.proxy=e(r.element(l)||h.drag)[0]),h.results.push(l),delete n.result;if(i!=="dropinit")return l}),s.results[c]=r.flatten(h.results),i=="dropinit"&&(h.droppable=r.flatten(h.droppable)),i=="dragstart"&&!h.cancelled&&d.update()}while(++c<v);return n.type=a.type,n.originalEvent=a.event,r.flatten(s.results)},properties:function(e,t,n){var i=n.callback;return i.drag=n.drag,i.proxy=n.proxy||n.drag,i.startX=t.pageX,i.startY=t.pageY,i.deltaX=e.pageX-t.pageX,i.deltaY=e.pageY-t.pageY,i.originalX=n.offset.left,i.originalY=n.offset.top,i.offsetX=i.originalX+i.deltaX,i.offsetY=i.originalY+i.deltaY,i.drop=r.flatten((n.drop||[]).slice()),i.available=r.flatten((n.droppable||[]).slice()),i},element:function(e){if(e&&(e.jquery||e.nodeType==1))return e},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?r.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",r.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};r.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,function(e){n.drop.locate(this,e)})}};var i=t.dispatch;t.dispatch=function(t){if(e.data(this,"suppress."+t.type)-(new Date).getTime()>0){e.removeData(this,"suppress."+t.type);return}return i.apply(this,arguments)};var s=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var r=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;r&&e.each(s.props,function(e,n){t[n]=r[n]})}return t}};n.draginit=n.dragstart=n.dragend=r})(jQuery); 
/*
 * debouncedresize: special jQuery event that happens once after a window resize
 *
 * latest version and complete README available on Github:
 * https://github.com/louisremi/jquery-smartresize
 *
 * Copyright 2012 @louis_remi
 * Licensed under the MIT license.
 *
 * This saved you an hour of work? 
 * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON
 */(function(e){var t=e.event,n,r;n=t.special.debouncedresize={setup:function(){e(this).on("resize",n.handler)},teardown:function(){e(this).off("resize",n.handler)},handler:function(e,i){var s=this,o=arguments,u=function(){e.type="debouncedresize",t.dispatch.apply(s,o)};r&&clearTimeout(r),i?u():r=setTimeout(u,n.threshold)},threshold:150}})(jQuery); 
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */(function(e){function r(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(i=n.wheelDelta/120),n.detail&&(i=-n.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=-1*i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=-1*n.wheelDeltaX/120),r.unshift(t,i,o,u),(e.event.dispatch||e.event.handle).apply(this,r)}var t=e.browser.mozilla?["MozMousePixelScroll"]:["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var n=t.length;n;)e.event.fixHooks[t[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],r,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(jQuery);